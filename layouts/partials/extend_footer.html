{{- /* Footer custom content area start */ -}}

<!-- Claude Talks Carousel -->
<script>
(function() {
  const track = document.getElementById('ct-track');
  const dots = document.getElementById('ct-dots');
  const prev = document.getElementById('ct-prev');
  const next = document.getElementById('ct-next');
  
  if (!track || !dots) return;
  
  const cards = track.querySelectorAll('.ct-card');
  const isMobile = window.innerWidth <= 768;
  const perView = isMobile ? 1 : 2;
  const totalSlides = Math.ceil(cards.length / perView);
  let current = 0;
  
  // Create dots
  for (let i = 0; i < totalSlides; i++) {
    const dot = document.createElement('span');
    dot.className = 'ct-dot' + (i === 0 ? ' active' : '');
    dot.addEventListener('click', () => goTo(i));
    dots.appendChild(dot);
  }
  
  function goTo(index) {
    current = Math.max(0, Math.min(index, totalSlides - 1));
    const cardWidth = cards[0].offsetWidth + 20; // gap
    track.style.transform = `translateX(-${current * perView * cardWidth}px)`;
    dots.querySelectorAll('.ct-dot').forEach((d, i) => {
      d.classList.toggle('active', i === current);
    });
  }
  
  if (prev) prev.addEventListener('click', () => goTo(current - 1));
  if (next) next.addEventListener('click', () => goTo(current + 1));
  
  // Touch/swipe support
  let startX = 0;
  let isDragging = false;
  
  track.addEventListener('touchstart', (e) => {
    startX = e.touches[0].clientX;
    isDragging = true;
  }, { passive: true });
  
  track.addEventListener('touchend', (e) => {
    if (!isDragging) return;
    const diff = startX - e.changedTouches[0].clientX;
    if (Math.abs(diff) > 50) {
      goTo(current + (diff > 0 ? 1 : -1));
    }
    isDragging = false;
  }, { passive: true });
  
  // Auto-advance every 6 seconds
  let autoplay = setInterval(() => goTo((current + 1) % totalSlides), 6000);
  
  // Pause on hover
  const feature = document.querySelector('.claude-talks-feature');
  if (feature) {
    feature.addEventListener('mouseenter', () => clearInterval(autoplay));
    feature.addEventListener('mouseleave', () => {
      autoplay = setInterval(() => goTo((current + 1) % totalSlides), 6000);
    });
  }
})();
</script>

<!-- Reading Progress Bar -->
<script>
(function() {
  if (!document.querySelector('.post-single')) return;
  
  const bar = document.createElement('div');
  bar.className = 'reading-progress';
  bar.style.width = '0%';
  document.body.appendChild(bar);
  
  window.addEventListener('scroll', function() {
    const h = document.documentElement;
    const pct = (h.scrollTop / (h.scrollHeight - h.clientHeight)) * 100;
    bar.style.width = Math.min(pct, 100) + '%';
  }, { passive: true });
})();
</script>

{{- /* Footer custom content area end */ -}}
